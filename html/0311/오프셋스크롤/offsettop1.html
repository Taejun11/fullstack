<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>offsettop1</title>
    <script src="https://code.jquery.com/jquery-3.1.1.js"></script>
    <script src="js/jquery.easing.1.3.js"></script>
    <script src="js/jquery.mousewheel.min.js"></script>
    <script src="js/jquery-ui.js"></script>
    <script src="js/jquery.cookie.js"></script>
    <!-- 쿠키를 저장할 수 있게 해주는 플러그인 -->
    <style>
        *{margin: 0; padding: 0;}
        a{text-decoration: none;}
        article{
            width: 100%;
            height: 100vh;
        }
        #article1{
            background-color: burlywood;
        }
        #article2{
            background-color: yellowgreen;
        }
        #article3{
            background-color: paleturquoise;
        }
        #article4{
            background-color: palegreen;
        }
        nav{
            position: absolute;
            top: 0;
            width: 100%;
            height: 100px;
            background-color: rgba(255, 255, 255, 0.5);
        }
        nav.on{/*바뀐부분*/
            position: fixed;
            background-color: rgba(0, 0, 0, 0.5);
        }
        nav.on ul li a{/*바뀐부분*/
            color: white;
        }
        nav ul{
            width: 1000px;
            height: 100px;
            margin: 0 auto;
            list-style: none;
        }
        nav ul li{
            float: left;
        }
        nav ul li a{
            display: block;
            width: 250px;
            height: 100px;
            line-height: 100px;
            font-size: 32px;
            color: black;
            text-align: center;
        }
        nav ul li.on a{
            color: orange;
            font-weight: bold;
        }
        nav.on ul li.on a{/*바뀐부분*/
            color: orange;
            font-weight: bold;
        }
        h2{
            position: fixed;
            bottom: 0;
            right: 0;
            z-index: 100;
        }
        #floatdiv{
            width: 70px;
            height: 200px;
            background-color: dimgrey;
            padding-top: 10px;
            position: absolute;
            top: 250px;
            right: 50px;
        }
        #floatdiv ul li{
            list-style: none;
            width: 25px;
            height: 25px;
            border-radius: 13px;
            background-color: white;
            margin-left: 20px;
            margin-top: 20px;
            cursor: pointer;
        }
        #floatdiv ul li.on{
            background-color: orange;
        }
        #popup{
            width: 301px;
            height: 351px;
            position: absolute;
            top: 210px;
            left: 50px;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
            display: none;
        }
        #notice_wrap{
            width: 301px;
            position: absolute;
            left: 400px;
            top: 210px;
            box-shadow: 0 0 8px black;
            font-size: 12px;
        }
        #notice_wrap img{float: left;}
        .close_wrap{
            background-color: black;
            color: white;
            text-align: right;
            padding: 5px 10px;
        }
        .close_wrap button{
            margin-left: 20px;
            cursor: pointer;
        }
    </style>

</head>
<body>
    <nav>
        <ul>
            <li class="on"><a href="#article1">회사소개</a></li>
            <li><a href="#article2">제품소개</a></li>
            <li><a href="#article3">커뮤니티</a></li>
            <li><a href="#article4">다운로드</a></li>
        </ul>
    </nav>
    <section>
        <article id="article1"></article>
        <article id="article2"></article>
        <article id="article3"></article>
        <article id="article4"></article>
    </section>
    <h2>현재 스크롤 위치 : <span id="sTop">000</span></h2>
    <div id="floatdiv">
        <ul>
            <li class="on"><span id="btn1"></span></li>
            <li><span id="btn2"></span></li>
            <li><span id="btn3"></span></li>
            <li><span id="btn4"></span></li>
        </ul>
    </div>
    <div id="popup">
        <img src="images/popup.jpg" alt="" usemap="#pop">
        <map name="pop" id="pop">
            <area shape="rect" coords="250,328 , 300,350" href="#" alt="창닫기">
            <area shape="rect" coords="88,328 , 220,350" href="#" alt="오늘 하루 열지않음">
        </map>
    </div>
    <div id="notice_wrap">
        <img src="images/popup1.jpg" alt="공지사항">
        <p class="close_wrap">
            <input type="checkbox" name="expiresChk" id="expiresChk">
            <label for="expiresChk">3일 동안 이 창 열지않기</label>
            <button class="closeBtn">닫기</button>
        </p>
    </div>
</body>
</html>

<script>
    $(function(){
        var a0 = $('section article').eq(0).offset().top;
        // console.log(a0); //100%기준 0
        var a1 = $('section article').eq(1).offset().top;
        // console.log(a1); //100%기준 962
        var a2 = $('section article').eq(2).offset().top;
        // console.log(a2); //100%기준 1924
        var a3 = $('section article').eq(3).offset().top;
        // console.log(a3); //100%기준 2886
        var dTop = $('#floatdiv').offset().top;

        $(window).scroll(function(){
            var sct = $(this).scrollTop(); // 스크롤의 위치값
            $('#sTop').text(sct);
            $('#floatdiv').stop().animate({top: dTop+sct},500);
            if(sct > 0){
                $('nav').addClass('on');
            }else{
                $('nav').removeClass('on');
            }
            // if (sct >= a0) {
            //     $('nav ul li').removeClass('on');
            //     $('nav ul li').eq(0).addClass('on');
            // }
            // if (sct >= a1) {
            //     $('nav ul li').removeClass('on');
            //     $('nav ul li').eq(1).addClass('on');
            // }
            // if (sct >= a2) {
            //     $('nav ul li').removeClass('on');
            //     $('nav ul li').eq(2).addClass('on');
            // }
            // if (sct >= a3) {
            //     $('nav ul li').removeClass('on');
            //     $('nav ul li').eq(3).addClass('on');
            // }
            for (var k = 0; k < 4; k++) {
                if (sct >= $('section article').eq(k).offset().top){
                    $('nav ul li').removeClass('on');
                    $('nav ul li').eq(k).addClass('on');
                    $('#floatdiv ul li').removeClass('on');
                    $('#floatdiv ul li').eq(k).addClass('on');
                }
            }
        });



        $('nav ul li').click(function(){
            var i = $(this).index();
            var offset_t = $('section article').eq(i).offset().top;
            // alert(offset_t);
            $('html, body').stop().animate({
                scrollTop: offset_t
            },1000);
            // if ($(this).hasClass('on') == false) {
            //     $('nav ul li').removeClass('on');
            //     $(this).addClass('on');
            // }
            // $('nav ul li').removeClass('on');
            // $('nav ul li').eq(i).addClass('on');
            return false;
        });

        // $('section article').mousewheel(function(event, d){
        //     // console.log(d);
        //     if (d > 0) {//휠을 올렸을 때
        //         var prev = $(this).prev().offset().top;
        //         $('html, body').stop().animate({
        //             scrollTop: prev
        //         }, 1000);
        //     }
        //     if (d < 0) {//휠을 올렸을 때
        //         var next = $(this).next().offset().top;
        //         $('html, body').stop().animate({
        //             scrollTop: next
        //         }, 1000);
        //     }
        // });

        $('#floatdiv ul li').click(function(){
            var i = $(this).index();
            var offset_t = $('section article').eq(i).offset().top;
            $('html, body').stop().animate({
                scrollTop: offset_t
            },1000);
            return false;
        });

        $('#popup').draggable();
        if ($.cookie('pop') != 'no') {//쿠키 pop변수에 no가 없을 경우 실행
            $('#popup').show();
        }
        $('#popup area:eq(0)').click(function(){
            $('#popup').fadeOut('fast');
            // 창닫기 버튼 클릭시 팝업창 서서히 사라짐
        });
        $('#popup area:eq(1)').click(function(){
            $.cookie('pop','no',{expires:1});
            $('#popup').fadeOut('fast');
            // 창닫기 버튼 클릭시 팝업창 서서히 사라짐
        });

        $('#notice_wrap').draggable();
        if ($.cookie('popup') == 'none') {//쿠키 pop변수에 none이 있을 경우 실행
            $('#notice_wrap').hide();
        }
        var chk = $('#expiresChk');
        $('.closeBtn').on('click',closePop);

        function closePop() {
            if (chk.is(':checked')) {//input 창에 체크 되어 있을 경우 실행
                $.cookie('popup','none',{expires:3});
                // chk가 체크되어 있으면 쿠키에 popup변수에 none을 3일동안 저장
            }
            $('#notice_wrap').fadeOut('fast');
        }
    });
</script>